$(function(){function e(){this.$elm={slides:$(".mv-crausel-item"),slide:{active:$(""),next:$("")}},this.CLASSNAME={ACTIVE:"is-active",SCALE:"is-scaling"},this.INTERVAL=8e3,this.index=0,this.length=this.$elm.slides.length,this.init()}function t(){this.$elm={newsArea:$("#news-area")},this.ENDPOINT="http://blog.signsplus.jp/wp-json/wp/v2/posts/",this.ENTRY={MAX:4},this.fetch()}var i=function(){$("a[href^=#]").click(function(){var e=$(this).attr("href"),t=$("#"===e||""===e?"html":e);return t.velocity("scroll",{duration:600,easing:"ease"}),!1})};new i;e.prototype={init:function(){return this.length>=1&&(this.scale(this.$elm.slides.eq(0)),void(this.length>=1&&this.autoplay()))},autoplay:function(){var e=this;setInterval(function(){e.toNext()},e.INTERVAL)},toNext:function(){var e=this.$elm.slides.index(this.$elm.slide.active),t=e===this.length-1?0:e+1;this.$elm.slide.active.removeClass(this.CLASSNAME.ACTIVE),this.scale(this.$elm.slides.eq(t))},scale:function(e){var t=this;this.$elm.slide.active=e,e.addClass(this.CLASSNAME.ACTIVE).addClass(this.CLASSNAME.SCALE).one("animationend webkitAnimationEnd",function(){$(this).removeClass(t.CLASSNAME.SCALE)})}},new e;for(var n=[],o=[{elm:".cafe-carousel"},{elm:".salon-carousel"}],a=0;a<o.length;a++)n[a]=new Swiper(o[a].elm,{pagination:".pager",paginationClickable:!0,slidesPerView:1,spaceBetween:0,loop:!0,speed:300,autoplay:8e3});var s=new google.maps.LatLng(32.774567,130.681359),l=new google.maps.LatLng(32.774567,130.681359),r={zoom:17,center:l,mapTypeControlOptions:{mapTypeIds:["mono"]},scrollwheel:!1,draggable:!1},c=new google.maps.Map(document.getElementById("Map"),r),d={url:"assets/images/access_ico.png",size:new google.maps.Size(24,36),scaledSize:new google.maps.Size(24,36)},h={position:s,map:c,icon:d},g=(new google.maps.Marker(h),[{stylers:[{saturation:-100},{lightness:20}]}]),m={name:""},u=new google.maps.StyledMapType(g,m);c.mapTypes.set("mono",u),c.setMapTypeId("mono");var p=function(){var e={target:$("#GlobalNavi"),header:$("#Header"),btn:$("#GlobalNavi .btn"),inline:$("#GlobalNavi .globalnavi-inline")},t={minHeight:400,inlineWidth:e.inline.width(),inlineHeight:0,windowWidth:0,windowHeight:0};this.initSetting=function(){v.resizeSetting(),$(window).resize(function(){v.resizeSetting()}),e.btn.on("click",function(){v.menuMovingStop(),e.header.hasClass("active")?v.menuClose():v.menuOpen()}),e.inline.find("li a").on("click",function(){e.header.hasClass("active")&&v.menuClose()})},this.menuOpen=function(){e.header.addClass("active"),$("html").addClass("locked"),v.resizeSetting(),e.btn.find(".n01").velocity({top:28},100).velocity({rotateZ:"45deg"},100),e.btn.find(".n02").velocity({opacity:0},100),e.btn.find(".n03").velocity({top:28},100).velocity({rotateZ:"-45deg"},100);e.inline.velocity({right:0},400),$(window).on("touchmove.noScroll",function(e){e.preventDefault()})},this.menuClose=function(){e.btn.find(".n01").velocity({rotateZ:"0deg"},100).velocity({top:20},100),e.btn.find(".n02").velocity({opacity:1},100),e.btn.find(".n03").velocity({rotateZ:"0deg"},100).velocity({top:36},100),e.inline.velocity({right:-t.inlineWidth},400,function(){v.menuMovingReset()}),$(window).off(".noScroll")},this.menuMovingStop=function(){e.btn.find(".n01").stop().velocity("stop"),e.btn.find(".n02").stop().velocity("stop"),e.btn.find(".n03").stop().velocity("stop"),e.inline.stop().velocity("stop")},this.menuMovingReset=function(){e.btn.find(".n01").css({top:""}).velocity({rotateZ:"0deg"},0),e.btn.find(".n02").css({opacity:""}),e.btn.find(".n03").css({top:""}).velocity({rotateZ:"0deg"},0),e.header.css({height:""}),e.target.css({height:""}),e.inline.css({height:"",right:""}),e.header.removeClass("active"),$("html").removeClass("locked"),$(window).off(".noScroll")},this.resizeSetting=function(){t.windowWidth=window.innerWidth,t.windowHeight=window.innerHeight,t.windowWidth<769&&e.header.hasClass("active")?(t.minHeight<t.windowHeight?t.inlineHeight=t.windowHeight:t.inlineHeight=t.minHeight,e.header.css({height:t.windowHeight}),e.target.css({height:t.inlineHeight}),e.inline.css({height:t.inlineHeight})):t.windowWidth>768&&(v.menuMovingStop(),v.menuMovingReset())}},v=new p,f=function(){var e={MV:$("#MV"),Header:$("#Header"),Footer:$("#Footer"),Content:$("#Content"),Preload:$("#Preload"),loading:$("#Preload .loading"),mvTitle:$(".mv-title"),mvTitleImg:$(".mv-title img")},t={width:$(window).outerWidth(),height:$(window).outerHeight()};$.preloadImages=function(){for(var e=0,t=arguments.length;e<t;e++)$("<img>").attr("src",arguments[e])},this.initSetting=function(){e.mvTitle.css({opacity:0}),e.loading.velocity({opacity:1},800,"linear"),w.preLoading(),w.resizeSetting(),$(window).on("resize",function(){w.resizeSetting()})},this.preLoading=function(){for(var t=0,i=$("img").length;t<i;t++){var n=$("img").eq(t).attr("src");$.preloadImages(n)}setTimeout(function(){w.mvStart().always(function(){e.Preload.velocity({opacity:0},{duration:1e3,easing:"linear",delay:400,complete:function(){e.Preload.remove(),e.mvTitle.css({zIndex:""})}})})},2e3)},this.mvStart=function(){var t=new $.Deferred;return e.loading.velocity({opacity:0},300,"easeOutCubic"),e.mvTitle.css({zIndex:1e4}).velocity({opacity:1},{duration:900,delay:700,easing:"linear",complete:function(){t.resolve()}}),t.promise()},this.resizeSetting=function(){t.width=$(window).outerWidth(),t.height=$(window).outerHeight();var i=0;i=$.device("smartphone")||$.device("tablet")?t.height<514?514:t.height:t.height<768?768:t.height,e.MV.css({height:i})}},w=new f,y=function(){this.initSetting=function(){for(var e=new ScrollMagic.Controller,t=[],i=[{elm:"#Concept"},{elm:"#Cafe"},{elm:"#Salon"},{elm:"#News"},{elm:"#Access"}],n=0,o=i.length;n<o;n++)t[n]=new ScrollMagic.Scene({triggerElement:i[n].elm,duration:$(i[n].elm).outerHeight(!0)}).addTo(e).on("enter",function(e){var t=$(e.target.triggerElement()).attr("id");$("#GlobalNavi").find("li."+t.toLowerCase()).addClass("current")}).on("leave",function(e){$("#GlobalNavi").find("li").removeClass("current")})}},S=new y,C=2516;if($.device("smartphone")||$.device("tablet"));else for(var b=Math.floor($(document).outerHeight()/C),a=0;a<b;a++){var M="<span></span>";$("#BG").append(M),$("#BG").find("span").eq(a).css({top:C*a+110})}var T=$("#Footer .bottom-logo");$(window).scroll(function(e){var t=$(window).scrollTop(),i=$(document).outerHeight()-$(window).outerHeight();t>100&&t<i-$("#Footer").outerHeight()?T.addClass("on"):T.removeClass("on")}),v.initSetting(),w.initSetting(),S.initSetting(),t.prototype={fetch:function(){var e=this;$.get(this.ENDPOINT).done(function(t){var i,n,o=t.length>e.ENTRY.MAX?e.ENTRY.MAX:t.length;for(i=0;i<o;i++)n=e.buildHTML(t[i]),e.append(n)})},buildHTML:function(e){var t=e.title.rendered,i=this.formatDate(e.date),n=this.extractImageFromContent(e.content.rendered),o=e.link,a='<section class="feed"><a href="'+o+'">';return a+='  <p class="photo"><span '+n+"></span></p>",a+='  <div class="feed-inline">',a+='    <h3><span class="date">'+i+"</span></h3>",a+="    <p>"+t+"</p>",a+="  </div>",a+="</a></section>"},formatDate:function(e){function t(e){return("0"+e).slice(-2)}var i=new Date(e),n=i.getFullYear(),o=t(i.getMonth()+1),a=t(i.getDate()+1);return n+"."+o+"."+a},extractImageFromContent:function(e){var t="",i=$(e).find("img"),n=i.length>0?i.attr("src"):null;return n&&(t='style="background-image: url('+n+');"'),t},append:function(e){this.$elm.newsArea.append(e)}},new t}),$(window).on("load",function(){setTimeout(function(){$("html,body").scrollTop(0)},0)});
